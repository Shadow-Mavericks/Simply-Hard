actor KunaisLifeStealingPuff : BulletPuff
{
	Radius 1
	Height 1
	+NOTIMEFREEZE
	+EXTREMEDEATH
	+PUFFONACTORS
	+PUFFGETSOWNER
	+FORCEPAIN
	+NOSPAWNEVENTSCRIPT
	States
	{
		XDeath:
		Spawn:
			KPUF A 3 Bright Light("KBPUFF1")
			KPUF B 3 Bright Light("KBPUFF2")
			goto Melee
		Melee:
			KPUF CDEFG 3 Bright
			stop
	}
}

ACTOR SoulreaperPuff : KunaisLifeStealingPuff //I know its for special effects but for this case, its honestly... just a sound for his soul reaper
{
	-FORCEPAIN
	-EXTREMEDEATH
	+NOEXTREMEDEATH
	Scale 0.5
	VSpeed 0
	States
	{
		Spawn:
			KPUF A 0
			goto Melee
		XDeath:
			KPUF A 0 A_PlaySound("Weapons/SReaperhit", CHAN_AUTO)
			goto Melee
	}
}

ACTOR SoulreaperPuff_SweetSpot : KunaisLifeStealingPuff
{
	VSpeed 0
	States
	{
		XDeath:
			KPUF A 0 A_PlaySound("Weapons/SReaperhit", CHAN_AUTO)
			KPUF A 3 Bright Light("KBPUFF1")
			KPUF B 3 Bright Light("KBPUFF2")
			goto Melee
		Spawn:
			KPUF A 0 NoDelay A_PlaySound("Weapons/Sreaperwall", CHAN_AUTO)
			KPUF A 3 Bright Light("KBPUFF1")
			KPUF B 3 Bright Light("KBPUFF2")
			goto Melee
	}
}

actor KunaisIcyPuff : BulletPuff
{
	Radius 1
	Height 1
	+NOTIMEFREEZE
	+EXTREMEDEATH
	+PUFFONACTORS
	+PUFFGETSOWNER
	+FORCEPAIN
	+NOSPAWNEVENTSCRIPT
	States
	{
		XDeath:
		Spawn:
			KBUF A 3 Bright Light("KICEBPUFF1")
			KBUF B 3 Bright Light("KICEBPUFF2")
			goto Melee
		Melee:
			KBUF CDEFG 3 Bright
			stop
	}
}

actor KunaisHealthStealBonus : HealthBonus
{
	Inventory.Amount 1
	Inventory.MaxAmount 150
}

ACTOR KunaisArmorStealBonus : BasicArmorBonus
{
	DamageFactor 0.75
	Armor.SavePercent 100
	Armor.SaveAmount 1
	Armor.MaxSaveAmount 100
}

actor HealingSeekerPuff : KunaisLifeStealingPuff
{
	RenderStyle Add
	Alpha 1.0
	Scale 0.5
	States
	{
		XDeath:
		Spawn:
		Melee:
			KPUF CDEFG 2 Bright
			stop
	}
}

actor HealingSeeker
{
	Radius 1
	Height 1
	Speed 30
	Scale 0.5
	RenderStyle Add
	Alpha 1.0

	var int user_healamt;

	Projectile
	+SEEKERMISSILE
	+NOCLIP
	+NOINTERACTION
	+NOTIMEFREEZE
	States
	{
		Spawn:
			KPUF AB 1 Bright A_SpawnItemEx("Red_Star_NoRise", 0, 0, 0, 0, 0, 0, 0, SXF_CLIENTSIDE, 0)
			KPUF A 0 A_ChangeVelocity(frandom(30, 32), 0.0, velz, CVF_RELATIVE | CVF_REPLACE)
			goto Seek
		Seek:
			KPUF A 1 Bright A_SeekerMissile(12.0, 24.0, SMF_PRECISE | SMF_CURSPEED, 256, 256)
			KPUF A 0 Bright A_SpawnItemEx("Red_Star_NoRise", 0, 0, 0, 0, 0, 0, 0, SXF_CLIENTSIDE, 0)
			KPUF B 1 Bright A_SeekerMissile(12.0, 24.0, SMF_PRECISE | SMF_CURSPEED, 256, 256)
			KPUF B 0 Bright A_SpawnItemEx("Red_Star_NoRise", 0, 0, 0, 0, 0, 0, 0, SXF_CLIENTSIDE, 0)
			KPUF A 0 A_JumpIfCloser(32, "Heal")
			loop
		Heal:
			KPUF A 0 ACS_NamedExecuteWithResult("KUNAI_SAP")
			KPUF A 0 A_SpawnItemEx("HealingSeekerPuff", 0, 0, 0, 0, 0, 0, 0, SXF_CLIENTSIDE, 0)
			KPUF A 0 A_PlaySound("SOTNHeartbeat", CHAN_AUTO, 0.5)
			TNT1 A 2
			stop
	}
}

actor AmmoSeeker : HealingSeeker
{
	States
	{
		Spawn:
			KBUF AB 1 Bright A_SpawnItemEx("Blue_Star_NoRise", 0, 0, 0, 0, 0, 0, 0, SXF_CLIENTSIDE, 0)
			KBUF A 0 A_ChangeVelocity(frandom(30, 32), 0.0, velz, CVF_RELATIVE | CVF_REPLACE)
			goto Seek
		Seek:
			KBUF A 1 Bright A_SeekerMissile(12.0, 24.0, SMF_PRECISE | SMF_CURSPEED, 256, 256)
			KBUF A 0 Bright A_SpawnItemEx("Blue_Star_NoRise", 0, 0, 0, 0, 0, 0, 0, SXF_CLIENTSIDE, 0)
			KBUF B 1 Bright A_SeekerMissile(12.0, 24.0, SMF_PRECISE | SMF_CURSPEED, 256, 256)
			KBUF B 0 Bright A_SpawnItemEx("Blue_Star_NoRise", 0, 0, 0, 0, 0, 0, 0, SXF_CLIENTSIDE, 0)
			KBUF A 0 A_JumpIfCloser(32, "GiveAmmo")
			loop
		GiveAmmo:
			KBUF A 0 ACS_NamedExecuteWithResult("KUNAI_SAP", 1) // 1 = SAP_AMMO
			KBUF A 0 A_SpawnItemEx("KunaisIcyPuff", 0, 0, 0, 0, 0, 0, 0, SXF_CLIENTSIDE, 0)
			KBUF A 0 A_PlaySound("PSAmmo", CHAN_AUTO, 0.5)
			TNT1 A 2
			stop
	}
}

Actor PowerShieldGate : Powerup { }
ACTOR ShieldGate : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Duration 5
	Powerup.Type "ShieldGate"
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
}

Actor PowerShieldGateCooldown : Powerup { }
ACTOR ShieldGateCooldown : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Duration 175
	Powerup.Type "ShieldGateCooldown"
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
}

actor ShieldBlast : CustomInventory
{
	Inventory.MaxAmount 0
	Inventory.Amount 1
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	States
	{
		Use:
			KPUF A 0 A_RadiusThrust(8192, 128, RTF_NOTMISSILE, 80) 
			KPUF A 0 A_SpawnItemEx("ShieldBlastWave", 0, 0, 2, 0, 0, 0, frandom(-180, 180), SXF_NOCHECKPOSITION, 0)
			KPUF A 0 A_RailWait
			stop
	}
}

actor ShieldBlastWave : SH_BaseParticle
{
	RenderStyle Add
	Alpha 1.0
	-CLIENTSIDEONLY
	States
	{
		Spawn:
			NULL A 0 NoDelay A_SpawnItemEx("ShieldBlastSphere", 0, 0, 0, 0, 0, 0, frandom(-180, 180), SXF_CLIENTSIDE | SXF_NOCHECKPOSITION, 0)
			NULL ABCDEFGH 1 Bright
			stop
	}
}

actor ShieldBlastSphere : ShieldBlastWave
{
	States
	{
		Spawn:
			NULL A 1 Bright
			NULL A 0 Bright A_FadeOut(0.125)
			NULL A 0 Bright A_SetScale(scalex+0.125)
			loop
	}
}

actor FrostShotTrail : CryoSmoke
{
	RenderStyle Shaded
	StencilColor "64 A0 A0"
	Scale 0.25
}

actor FrostShotBallTrail : CryoSmoke
{
	RenderStyle Shaded
	StencilColor "64 A0 A0"
	Scale 0.1
}

actor FrostShotExplosionMist : CryoSmoke4
{
	StencilColor "64 A0 A0"
	Alpha 0.5
	Scale 0.5
}

actor FrostShotGrenade : SH_BaseProjectile
{
	Radius 4
	Height 8
	Scale 0.5
	Speed 30
	Gravity 0.125
	Damage (1)
	BounceType "Doom"
	BounceFactor 1.0
	BounceCount 2
	ReactionTime 15
	+FORCERADIUSDMG
	+BOUNCEAUTOOFFFLOORONLY
	+SKYEXPLODE
	-NOGRAVITY
	
	var int user_last_velx;
	var int user_last_vely;
	var int user_last_velz;
	
	States
	{
		Spawn:
			KGRN A 1 A_SpawnItemEx("FrostShotTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 0)
			KGRN A 0 A_SetUserVar("user_last_velx", velx)
			KGRN A 0 A_SetUserVar("user_last_vely", vely)
			KGRN A 0 A_SetUserVar("user_last_velz", velz)
			KGRN A 0 A_CountDown
			loop
		Death:
			FX02 F 0 A_PlaySound("FrostShotExplode", CHAN_AUTO)
			FX02 FFFFFFFFFF 0 A_SpawnItemEx("FrostShotBallBig", 0, 0, 0, user_last_velx+frandom[frostnade1](-4.0, 4.0), user_last_vely+frandom[frostnade1](-4.0, 4.0), user_last_velz+frandom[frostnade1](-4.0, 4.0), 0, SXF_NOCHECKPOSITION | SXF_ABSOLUTEVELOCITY, 0)
			FX02 F 0 A_SpawnItemEx("FrostShotExplosionMist", 0, 0, 0, 0, 0, 0, SXF_CLIENTSIDE, 0)
			FX02 F 0 A_SetScale(1.5)
			FX02 F 0 A_SetTranslucent(1.0, 1)
			FX02 F 0 A_SetDamageType("Ice")
			FX02 F 0 A_Explode(50, 80, 0, false, 48)
			FX02 FGHIJ 2 Bright
			stop
	}
}

actor FrostShotBallBig : FrostShotGrenade
{
	Radius 2
	Height 4
	Damage (10)
	DamageType "Ice"
	BounceSound "FrostBallRicochet"
	BounceCount 2
	+BOUNCEONACTORS
	States
	{
		Spawn:
			FX02 C 1
			FX02 C 0 A_ChangeFlag("BOUNCEONACTORS", false)
			goto SpawnLoop
		SpawnLoop:
			FX02 C 1 A_SpawnItemEx("FrostShotBallTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 0)
			"####" "#" 0 A_SetUserVar("user_last_velx", velx)
			"####" "#" 0 A_SetUserVar("user_last_vely", vely)
			"####" "#" 0 A_SetUserVar("user_last_velz", velz)
			FX02 C 1 A_SpawnItemEx("FrostShotBallTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 0)
			"####" "#" 0 A_SetUserVar("user_last_velx", velx)
			"####" "#" 0 A_SetUserVar("user_last_vely", vely)
			"####" "#" 0 A_SetUserVar("user_last_velz", velz)
			FX02 C 1 A_SpawnItemEx("FrostShotBallTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 0)
			"####" "#" 0 A_SetUserVar("user_last_velx", velx)
			"####" "#" 0 A_SetUserVar("user_last_vely", vely)
			"####" "#" 0 A_SetUserVar("user_last_velz", velz)
			FX02 C 1 A_SpawnItemEx("FrostShotBallTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 0)
			"####" "#" 0 A_SetUserVar("user_last_velx", velx)
			"####" "#" 0 A_SetUserVar("user_last_vely", vely)
			"####" "#" 0 A_SetUserVar("user_last_velz", velz)
			FX02 D 1 A_SpawnItemEx("FrostShotBallTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 0)
			"####" "#" 0 A_SetUserVar("user_last_velx", velx)
			"####" "#" 0 A_SetUserVar("user_last_vely", vely)
			"####" "#" 0 A_SetUserVar("user_last_velz", velz)
			FX02 D 1 A_SpawnItemEx("FrostShotBallTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 0)
			"####" "#" 0 A_SetUserVar("user_last_velx", velx)
			"####" "#" 0 A_SetUserVar("user_last_vely", vely)
			"####" "#" 0 A_SetUserVar("user_last_velz", velz)
			FX02 D 1 A_SpawnItemEx("FrostShotBallTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 0)
			"####" "#" 0 A_SetUserVar("user_last_velx", velx)
			"####" "#" 0 A_SetUserVar("user_last_vely", vely)
			"####" "#" 0 A_SetUserVar("user_last_velz", velz)
			FX02 D 1 A_SpawnItemEx("FrostShotBallTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 0)
			"####" "#" 0 A_SetUserVar("user_last_velx", velx)
			"####" "#" 0 A_SetUserVar("user_last_vely", vely)
			"####" "#" 0 A_SetUserVar("user_last_velz", velz)
			loop
		Death:
			FX02 F 0 A_PlaySound("FrostBallExplode", CHAN_AUTO, 0.5)
			FX02 FFFFF 0 A_SpawnItemEx("FrostShotBallSmall", 0, 0, 0, user_last_velx+frandom[frostnade2](-4.0, 4.0), user_last_vely+frandom[frostnade2](-4.0, 4.0), user_last_velz+frandom[frostnade2](-4.0, 4.0), 0, SXF_NOCHECKPOSITION | SXF_ABSOLUTEVELOCITY, 0)
			FX02 F 0 A_SetScale(1.0)
			FX02 F 0 A_SetTranslucent(1.0, 1)
			FX02 F 0 A_Explode(10, 32, 0, false, 16)
			FX02 FGHIJ 2 Bright
			stop
	}
}

actor FrostShotBallSmall : FrostShotBallBig
{
	Radius 2
	Height 2
	Damage (2)
	States
	{
		Spawn:
			FX02 A 1
			FX02 A 0 A_ChangeFlag("BOUNCEONACTORS", false)
			goto SpawnLoop
		SpawnLoop:
			FX02 AAAABBBB 1 A_SpawnItemEx("FrostShotBallTrail", 0, 0, 0, frandom(-1.0, 1.0), frandom(-1.0, 1.0), frandom(-1.0, 1.0), 0, SXF_CLIENTSIDE, 128)
			loop
		Death:
			FX02 F 0 A_SetScale(0.75)
			FX02 F 0 A_SetTranslucent(1.0, 1)
			FX02 FGHIJ 2 Bright
			stop
	}
}


ACTOR Soulreaper : SH_Weapon
{
	Tag "Soul-Reaper"
	Game Doom
	Inventory.ForbiddenTo "Maximusprime"
	Weapon.SelectionOrder 8
	Weapon.slotnumber 1
	Weapon.Kickback 100
	Inventory.ForbiddenTo "Fiend"
	Inventory.ForbiddenTo "Gosimer"
	Inventory.RestrictedTo "Kunai"
	Inventory.PickupSound "weapon/srget"
	Weapon.BobStyle "InverseSmooth"
	Weapon.BobSpeed 1.5
	Weapon.BobRangeX .5
	+WEAPON.NOALERT
	+WEAPON.NOAUTOAIM
	+WEAPON.MELEEWEAPON
	States
	{
		Ready:
			KRDY AAABBBCCCDDD 1 A_WeaponReady
			Loop
		Deselect:
			KRDY AA 0 A_Lower
			KRDY A 1 A_Lower
			KRDY AA 0 A_Lower
			KRDY A 1 A_Lower
			KRDY AA 0 A_Lower
			KRDY A 1 A_Lower
			
			KRDY BB 0 A_Lower
			KRDY B 1 A_Lower
			KRDY BB 0 A_Lower
			KRDY B 1 A_Lower
			KRDY BB 0 A_Lower
			KRDY B 1 A_Lower
			Loop
		Select:
			KRDY AA 0 A_Raise
			KRDY A 1 A_Raise
			KRDY AA 0 A_Raise
			KRDY A 1 A_Raise
			KRDY AA 0 A_Raise
			KRDY A 1 A_Raise
			
			KRDY BB 0 A_Raise
			KRDY B 1 A_Raise
			KRDY BB 0 A_Raise
			KRDY B 1 A_Raise
			KRDY BB 0 A_Raise
			KRDY B 1 A_Raise
			Loop
		Fire:
			KBLD A 0 A_WeaponReady(WRF_NOFIRE) // Reset offsets
			KBLD A 2
			KBLD B 2
			KBLD C 1 A_JumpIfInventory("PowerStrength", 1, "Berserked")
			KBLD D 0 A_AlertMonsters(192)
			Goto Normal
		Normal:
			KBLD D 1 A_playsound("weapons/srswing", Chan_6)
			KBLD E 1 A_FireBullets(-30.0, -4.0, -1, 32, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD F 1 A_FireBullets(-16.0, 0.0, -1, 32, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD G 1 A_FireBullets(0.0, 2.0, -1, 32, "SoulreaperPuff_SweetSpot", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD H 1 A_FireBullets(8.0, 4.0, -1, 32, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD I 1 A_FireBullets(16.0, 6.0, -1, 32, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD J 1 A_FireBullets(32.0, 8.0, -1, 32, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD K 1 A_FireBullets(40.0, 10.0, -1, 32, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD L 2 A_FireBullets(44.0, 16.0, -1, 32, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			TNT1 A 10 A_AlertMonsters(128)
			TNT1 A 0 A_ReFire
			KRDY A 1 Offset(16, 152) A_ReFire
			KRDY A 1 Offset(14, 137) A_ReFire
			KRDY B 1 Offset(12, 122) A_ReFire
			KRDY B 1 Offset(10, 107) A_ReFire
			KRDY C 1 Offset(8, 92) A_ReFire
			KRDY C 1 Offset(6, 77) A_ReFire
			KRDY D 1 Offset(4, 62) A_ReFire
			KRDY D 1 Offset(2, 47) A_ReFire
			Goto Ready
		Berserked:
			KBLD D 1 A_playsound("weapons/srswing", Chan_6)
			KBLD E 1 A_FireBullets(-30.0, -4.0, -1, 64, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD F 1 A_FireBullets(-16.0, 0.0, -1, 64, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD G 1 A_FireBullets(0.0, 2.0, -1, 64, "SoulreaperPuff_SweetSpot", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD H 1 A_FireBullets(8.0, 4.0, -1, 64, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD I 1 A_FireBullets(16.0, 6.0, -1, 64, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD J 1 A_FireBullets(32.0, 8.0, -1, 64, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD K 1 A_FireBullets(40.0, 10.0, -1, 64, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			KBLD L 2 A_FireBullets(44.0, 16.0, -1, 64, "SoulreaperPuff", FBF_EXPLICITANGLE | FBF_NORANDOM | FBF_NORANDOMPUFFZ | FBF_NOFLASH, 96.0)
			TNT1 A 10 A_AlertMonsters(128)
			TNT1 A 0 A_ReFire
			KRDY A 1 Offset(16, 152) A_ReFire
			KRDY A 1 Offset(14, 137) A_ReFire
			KRDY B 1 Offset(12, 122) A_ReFire
			KRDY B 1 Offset(10, 107) A_ReFire
			KRDY C 1 Offset(8, 92) A_ReFire
			KRDY C 1 Offset(6, 77) A_ReFire
			KRDY D 1 Offset(4, 62) A_ReFire
			KRDY D 1 Offset(2, 47) A_ReFire
			Goto Ready
		AltFire:
			KRDY A 0 A_WeaponReady(WRF_NOFIRE) // Reset offsets
			KBLD A 0 A_JumpIfInventory("AbilityCharge", 25, "Bladebem")
			KRDY AAABBBCCCDDD 1 A_WeaponReady(WRF_NOSECONDARY)
			Goto Ready
		Bladebem:
			KBLD D 0 A_AlertMonsters(384)
			KBLD D 1 A_playsound("weapons/srswing", Chan_6)
			KBLD E 1
			KBLD F 1 A_takeinventory("AbilityCharge",25)
			KBLD G 1 A_FireCustomMissile("Beem_Slash",0,0,0,0,0)
			KBLD H 1
			KBLD I 1
			KBLD J 2
			KBLD L 2
			TNT1 A 10 A_AlertMonsters(192)
			KRDY A 0 A_ReFire
			KRDY A 1 Offset(16, 152) A_ReFire
			KRDY A 1 Offset(14, 137) A_ReFire
			KRDY B 1 Offset(12, 122) A_ReFire
			KRDY B 1 Offset(10, 107) A_ReFire
			KRDY C 1 Offset(8, 92) A_ReFire
			KRDY C 1 Offset(6, 77) A_ReFire
			KRDY D 1 Offset(4, 62) A_ReFire
			KRDY D 1 Offset(2, 47) A_ReFire
			Goto Ready
	}
}

actor REV_Shot : Ammo
{
	+INVENTORY.IGNORESKILL
	inventory.maxamount 6
}

actor FanCount : Inventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 6
	+INVENTORY.ALWAYSPICKUP
}

Actor Highnoon : Inventory
{
	Radius 12
	Height 18
	scale 1
	Inventory.MaxAmount 1
	Inventory.PickupMessage "Reach for the sky!"
	States
	{
		Spawn:
			PIST A -1
			Stop
	}
}

ACTOR Kunaisrevolver : SH_Weapon //Weapon base from Golden souls
{
	Tag "Colt Python .357 Magnum"
	Decal BulletChip
	Weapon.SelectionOrder 7
	Weapon.SlotNumber 2
	
	Weapon.AmmoUse1 0
	Weapon.AmmoUse2 1
	Weapon.AmmoGive1 18
	Weapon.AmmoType1 "Peastolclip"
	Weapon.AmmoType2 "REV_SHOT"
	
	Weapon.BobSpeed 1.5
	Weapon.BobRangeX .5
	Weapon.BobStyle "InverseSmooth"
	
	Weapon.SwayStyle "HorizontalOnly"
	Weapon.ViewSwaySpeed 1.0
	
	Weapon.SisterWeapon "HighNoonPython"
	Weapon.PowerupItem "Tier1upgradetoken"
	
	Inventory.RestrictedTo "Kunai"
	Inventory.PickupSound "misc/w_pkup"
	
	+WEAPON.ALT_AMMO_OPTIONAL
	+WEAPON.NOAUTOAIM
	+DONTGIB
	States
	{
		Ready:
			NULL A 0 A_JumpIfInventory("Reload",0,"Reload")
			COLT A 1 A_WeaponReady(WRF_ALLOWRELOAD)
			Loop
		Deselect:
			COLT A 0 A_TakeInventory("Reload",1)
			COLT AA 0 A_Lower
			COLT A 1 A_Lower
			loop
		Select:
			COLT AA 0 A_Raise
			COLT A 1 A_Raise
			Loop
		Fire:
			NULL A 0 A_JumpIfInventory("REV_SHOT",1,1)
			Goto Dryfire
			COLT A 1 A_TakeInventory("REV_SHOT",1)
			COLT B 1 A_Playsound("REVFIRE", CHAN_WEAPON)
			COLT C 1 BRIGHT A_FireBullets(0, 0, -1, 20, "BulletPuff",1)
			TNT1 A 0 A_GunFlash
			TNT1 A 0
			COLT D 1
			TNT1 A 0
			COLT E 4
			COLT D 5
			COLT A 1 A_refire
			Goto Ready
		DryFire:
			COLT A 3 A_WeaponReady(WRF_NOFIRE)
			COLT A 0 A_PlaySound("weapons/pistol/dry", CHAN_AUTO)
			COLT B 2 A_WeaponReady(WRF_NOFIRE)
			Goto Reload

		AltFire:
			COLT A 0 A_TakeInventory("FanCount", 6)
			NULL A 0 A_JumpIfInventory("REV_SHOT",1,"AltStart")
			Goto AltFireDry
		AltStart:
			HCLT A 4
			HCLT B 4
			goto AltLoop
		AltLoop:
			HCLT C 2
			HCLT D 2 BRIGHT A_Playsound("REVFIRE", CHAN_WEAPON)
			HCLT E 2 BRIGHT A_FireBullets(3.5, 3.5, -1, 20,"BulletPuff", FBF_USEAMMO)
			HCLT E 0 BRIGHT A_GunFlash
			NULL A 0 A_GiveInventory("FanCount", 1)
			NULL A 0 A_JumpIfInventory("FanCount", 6, "AltEnd")
			NULL A 0 A_JumpIfInventory("REV_SHOT", 1, "AltLoop")
			Goto AltLoopDry
		AltEnd:
			HCLT F 4
			HCLT G 4
			goto Reload
		AltFireDry:
			HCLT A 4
			HCLT B 4
			HCLT C 4
			NULL A 0 A_PlaySound("weapons/pistol/dry", CHAN_AUTO)
			HCLT F 4
			HCLT G 4
			COLT A 4
			Goto Reload
		AltLoopDry:
			NULL A 0 A_PlaySound("weapons/pistol/dry", CHAN_AUTO)
			HCLT F 4
			HCLT G 4
			COLT A 4
			Goto Reload

		Reload:
			NULL A 0 A_TakeInventory("Reload",1)
			NULL A 0 A_JumpIfInventory("REV_SHOT",0,"Ready")
			NULL A 0 A_JumpIfInventory("Peastolclip",1,"ReloadStart")
			Goto Ready
		ReloadStart:
			NULL A 0 A_PlaySound("REVOPEN",chan_5)
			COLT FGHIJ 2 A_WeaponReady(WRF_NOFIRE)
			NULL A 0 A_PlaySound("REVEJECT",chan_5)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			COLT K 2 A_WeaponReady(WRF_NOFIRE)
			COLT LM 2 A_WeaponReady(WRF_NOFIRE)
			COLT M 10 A_WeaponReady(WRF_NOFIRE)
			COLT ML 2 A_WeaponReady(WRF_NOFIRE)
			NULL A 0 A_PlaySound("REVINSERT",chan_5)
			COLT KJIHGF 2 A_WeaponReady(WRF_NOFIRE)
			NULL A 0 A_PlaySound("REVCLOSE",chan_5)
			COLT A 2 A_WeaponReady(WRF_NOFIRE)
		ReloadAmmoLoop:
			NULL A 0 A_TakeInventory("Peastolclip",1)
			NULL A 0 A_GiveInventory("REV_SHOT",1)
			NULL A 0 A_JumpIfInventory("Peastolclip",1,1) // if not out of ammo, countinue reloading
			goto ReloadEnd
			NULL A 0 A_JumpIfInventory("REV_SHOT",0,"ReloadEnd") // if clip full, finish reload
			goto ReloadAmmoLoop // otherwise continue
		ReloadEnd:
			COLT A 1 A_WeaponReady(WRF_NOFIRE)
			COLT A 1 A_weaponready
			Goto Ready

		Flash:
			TNT1 A 0 A_Light2
			TNT1 A 1 A_SetPitch(pitch-0.9)
			TNT1 A 0 A_Light1
			TNT1 A 1 A_SetPitch(pitch+0.3)
			TNT1 A 0 A_Light0
			TNT1 AA 1 A_SetPitch(pitch+0.3)
			Goto LightDone
		
		Spawn:
			PIST A -1
			Stop
	}
}

actor HighNoonPython : Kunaisrevolver
{
	Tag "Kunai's High Noon Python (Tier 1 Upgrade)"
	
	Weapon.SisterWeapon "Kunaisrevolver"	
	+WEAPON.POWERED_UP
	
	States
	{
		Ready:
			GOLT A 0 A_JumpIfInventory("Highnoon", 1,"HNReady")
			GOLT A 0 A_JumpIfInventory("Reload", 0, "Reload")
			GOLT A 1 A_WeaponReady (WRF_ALLOWRELOAD)
			Loop
			
		Select:
			GOLT AA 0 A_Raise
			GOLT A 1 A_Raise
			Loop
			
		Deselect:
			GOLT A 0 A_JumpIfInventory("Highnoon",1,"HNDeselect")
			GOLT A 0 A_TakeInventory("Reload",1)
			GOLT AA 0 A_Lower
			GOLT A 1 A_Lower
			loop

		Fire:
			GOLT A 0 A_JumpIfInventory("Highnoon", 1,"HNFire")
			GOLT A 0 A_JumpIfInventory("REV_SHOT",1,1)
			Goto Dryfire
			GOLT A 1 A_TakeInventory("REV_SHOT",1)
			GOLT B 1 A_Playsound("REVFIRE", CHAN_WEAPON)
			GOLT C 0 A_Jump(64, "FireCrit")
			GOLT C 0 BRIGHT A_FireBullets(2, 2, -1, 25,"BulletPuff", FBF_USEAMMO)
			goto FireEnd
		FireCrit:
			GOLT C 0 BRIGHT A_PlaySound("GenericCrit", CHAN_AUTO)
			GOLT C 0 BRIGHT A_FireBullets(2, 2, -1, 75,"KunaisLifeStealingPuff", FBF_USEAMMO | FBF_NORANDOM)
			goto FireEnd
		FireEnd:
			GOLT C 1 BRIGHT A_GunFlash
			GOLT D 1
			GOLT E 4
			GOLT D 5
			GOLT A 1 A_refire
			Goto Ready
		DryFire:
			GOLT A 3 A_WeaponReady(WRF_NOFIRE)
			GOLT B 0 A_PlaySound("weapons/pistol/dry", CHAN_AUTO)
			GOLT B 2 A_WeaponReady(WRF_NOFIRE)
			Goto Reload

		
		AltFire:
			COLT A 0 A_TakeInventory("FanCount", 6)
			GOLT A 0 A_JumpIfInventory("REV_SHOT",1, "AltStart")
			Goto AltDry
		AltStart:
			HGLT A 4
			HGLT B 4
			goto AltLoop
		AltLoop:
			HGLT C 2
			HGLT D 2 BRIGHT A_PlaySound("REVFIRE", CHAN_WEAPON)
			HGLT E 0 BRIGHT A_FireBullets(3, 3, -1, 25,"BulletPuff", FBF_USEAMMO)
			HGLT E 2 BRIGHT A_GunFlash
			NULL A 0 A_GiveInventory("FanCount", 1)
			NULL A 0 A_JumpIfInventory("FanCount", 6, "AltEnd")
			NULL A 0 A_JumpIfInventory("REV_SHOT", 1, "AltLoop")
			Goto AltLoopDry
		AltEnd:
			HGLT F 4
			HGLT G 4
			goto Reload
		AltDry:
			HGLT A 4
			HGLT B 4
			HGLT C 4
			NULL A 0 A_PlaySound("weapons/pistol/dry", CHAN_AUTO)
			HGLT F 4
			HGLT G 4
			GOLT A 4
			Goto Reload
		AltLoopDry:
			NULL A 0 A_PlaySound("weapons/pistol/dry", CHAN_AUTO)
			HGLT F 4
			HGLT G 4
			GOLT A 4
			Goto Reload

		HNReady:
			HGLT B 4
			goto HNReadyLoop
		HNReadyLoop:
			HGLT C 1 A_WeaponReady(WRF_NOSECONDARY)
			loop
		HNDeselect:
			HGLT A 0 A_TakeInventory("Reload",1)
			HGLT F 4
			HGLT G 4
			GOLT AA 0 A_Lower
			GOLT A 1 A_Lower
			Goto HNDeselect+3
		HNFire:
			NULL A 0 A_TakeInventory("Highnoon",1)
			NULL A 0 A_TakeInventory("FanCount", 6)
			goto HNFireLoop
		HNFireLoop:
			HGLT C 2 A_TakeInventory("REV_SHOT",1)
			HGLT D 2 BRIGHT A_Playsound("REVFIRE", CHAN_WEAPON)
			HGLT E 0 BRIGHT A_PlaySound("GenericCrit", CHAN_AUTO)
			HGLT E 0 BRIGHT A_FireBullets(1, 1, -1, 150,"KunaisLifeStealingPuff", 0)
			HGLT E 2 BRIGHT A_GunFlash
			HGLT E 0 A_GiveInventory("FanCount", 1)
			HGLT E 0 A_JumpIfInventory("FanCount", 6, "HNFireEnd")
			loop
		HNFireEnd:
			HGLT F 4
			HGLT G 4
			goto Reload
			
		Reload:
			NULL A 0 A_TakeInventory("Reload",1)
			NULL A 0 A_JumpIfInventory("REV_SHOT",0,"Ready")
			NULL A 0 A_JumpIfInventory("Peastolclip",1,1)
			Goto Ready
			NULL A 0 A_PlaySound("REVOPEN",chan_5)
			GOLT FGHIJ 2 A_WeaponReady(WRF_NOFIRE)
			NULL A 0 A_PlaySound("REVEJECT",chan_5)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			NULL A 0 A_FireCustomMissile("PistolCasingSpawner", 0, 0, 0, 0)
			GOLT K 2 A_WeaponReady(WRF_NOFIRE)
			GOLT LM 2 A_WeaponReady(WRF_NOFIRE)
			GOLT M 10 A_WeaponReady(WRF_NOFIRE)
			GOLT ML 2 A_WeaponReady(WRF_NOFIRE)
			NULL A 0 A_PlaySound("REVINSERT",chan_5)
			GOLT KJIHGF 2 A_WeaponReady(WRF_NOFIRE)
			NULL A 0 A_PlaySound("REVCLOSE",chan_5)
			GOLT A 2 A_WeaponReady(WRF_NOFIRE)
			Goto ReloadAmmoLoop
		ReloadEnd:
			GOLT A 1 A_WeaponReady(WRF_NOFIRE)
			GOLT A 1 A_weaponready
			GOLT A 0 A_Jump(25, "ItsHighnoon")
			Goto Ready
		ItsHighnoon:
			NULL A 0 A_Giveinventory("Highnoon",1)
			HGLT A 4 ACS_Namedexecutewithresult("sv_highnoon")
			HGLT B 4
			HGLT C 70
			goto HNReadyLoop
	}
}

//Kunai Single Shotgun
ACTOR HelltechShotgun : SH_Weapon //Weapon from Laundry
{
	Tag "HellTech Shotgun"
	Decal BulletChip
	Inventory.RestrictedTo "Kunai"
	Inventory.Respawntics"4200"
	Inventory.PickupSound "weapon/singleget"
	
	Weapon.AmmoType "Shellz"
	Weapon.SelectionOrder 6
	Weapon.SlotNumber 3
	Weapon.AmmoUse1 1
	Weapon.AmmoGive 0 // Handled in ACS
	
	Weapon.BobSpeed 1.5
	Weapon.BobRangeX .5
	Weapon.BobStyle "InverseSmooth"
	
	Weapon.SwayStyle "HorizontalOnly"
	Weapon.ViewSwaySpeed 1.0
	
	Weapon.SisterWeapon "HelltechShotgunWithFrostShot"
	Weapon.PowerupItem "Tier2upgradetoken"
	
	+WEAPON.NOAUTOAIM
	States
	{
		Ready:
			SNGL A 1 A_WeaponReady
			Loop
		Deselect:
			SNGL AA 0 A_Lower
			SNGL A 1 A_Lower
			Loop
		Select:
			SNGL AA 0 A_Raise
			SNGL A 1 A_Raise
			Loop
		Fire:
			SNGL A 1 A_Playsound("Kunaishotgun_FIRE",Chan_weapon)
			SNGL A 0 A_FireBullets (3, 3, 10, 5, "BulletPuff")
			goto FireAnim
		FireAnim:
			"####" B 0 BRIGHT A_GunFlash
			"####" B 1 BRIGHT A_ClientsideACSExecute("SET_RECOIL_VALUE", random(-4, 4), 0)
			"####" C 1 BRIGHT A_WeaponOffset(CallACS("GET_RECOIL_X", 0)/FIXED, 32, 0)
			"####" D 1 BRIGHT A_WeaponOffset(CallACS("GET_RECOIL_X", 1)/FIXED, 32, 0)
			"####" E 1 A_WeaponOffset(CallACS("GET_RECOIL_X", 2)/FIXED, 32, 0)
			"####" F 1 A_WeaponOffset(CallACS("GET_RECOIL_X", 3)/FIXED, 32, 0)
			"####" G 1 A_WeaponOffset(CallACS("GET_RECOIL_X", 4)/FIXED, 32, 0)
			"####" G 1 A_WeaponOffset(0, 32, 0)
			"####" H 3
			"####" A 4
			"####" A 0 A_JumpIfInventory("PowerDoubleFiringSpeed", 1, "PumpAnimRage")
			goto PumpAnim
		PumpAnim:
			"####" III 1 A_WeaponOffset(2, -2, WOF_ADD)
			"####" J 0 A_WeaponOffset(0, 32, 0)
			"####" JJJ 1 A_WeaponOffset(2, 0, WOF_ADD)
			"####" K 0 A_WeaponOffset(0, 32, 0)
			"####" K 1 A_playsound("Kunaishotgun_Pump",Chan_6)
			"####" KK 1 A_WeaponOffset(2, 0, WOF_ADD)
			"####" KK 1 A_WeaponOffset(1, 1, WOF_ADD)
			"####" L 1 A_WeaponOffset(0, 32, 0)
			"####" L 1 A_WeaponOffset(1, 2, WOF_ADD)
			"####" L 1 A_WeaponOffset(0, 2, WOF_ADD) // Pump bottomed out, now go back up
			"####" LL 1 A_WeaponOffset(0, -1, WOF_ADD)
			"####" L 1 A_WeaponOffset(-1, -1, WOF_ADD)
			"####" K 2 A_WeaponOffset(0, 34, 0)
			"####" KK 1 A_WeaponOffset(-1, -1, WOF_ADD)
			"####" J 1 A_WeaponOffset(-4, 0, WOF_ADD)
			"####" II 1 A_WeaponOffset(2, 32, 0)
			"####" I 1 A_WeaponOffset(1, 32, 0)
			"####" I 1 A_WeaponOffset(0, 32, 0)
			"####" H 2
			"####" A 1
			"####" A 0 A_ReFire
			"####" A 0 A_JumpTo("Ready")
			goto Ready
		PumpAnimRage:
			"####" I 1 A_WeaponOffset(6, -6, WOF_ADD)
			"####" J 0 A_WeaponOffset(0, 32, 0)
			"####" J 1 A_WeaponOffset(6, 0, WOF_ADD)
			"####" K 0 A_WeaponOffset(0, 32, 0)
			"####" K 1 A_playsound("Kunaishotgun_Pump",Chan_6)
			"####" K 1 A_WeaponOffset(4, 0, WOF_ADD)
			"####" K 1 A_WeaponOffset(2, 2, WOF_ADD)
			"####" L 1 A_WeaponOffset(0, 32, 0)
			"####" L 1 A_WeaponOffset(2, 4, WOF_ADD) // Pump bottomed out, now go back up
			"####" L 1 A_WeaponOffset(0, -2, WOF_ADD)
			"####" L 1 A_WeaponOffset(-1, -1, WOF_ADD)
			"####" K 2 A_WeaponOffset(0, 34, 0)
			"####" K 1 A_WeaponOffset(-2, -2, WOF_ADD)
			"####" J 1 A_WeaponOffset(-4, 0, WOF_ADD)
			"####" I 1 A_WeaponOffset(4, 32, 0)
			"####" I 1 A_WeaponOffset(1, 32, 0)
			"####" I 1 A_WeaponOffset(0, 32, 0)
			"####" H 2
			"####" A 1
			"####" A 0 A_ReFire
			"####" A 0 A_JumpTo("Ready")
			goto Ready
		Flash:
			TNT1 A 0 Bright A_SetPitch(pitch-1.8)
			TNT1 A 1 Bright A_Light1
			TNT1 A 0 Bright A_SetPitch(pitch+0.6)
			TNT1 A 1 Bright A_Light2
			TNT1 A 0 Bright A_SetPitch(pitch+0.6)
			TNT1 A 1 Bright A_Light1
			TNT1 A 0 Bright A_SetPitch(pitch+0.6)
			Goto LightDone
		Spawn:
			SHOT A -1
			Stop
	}
}

ACTOR HelltechShotgunWithFrostShot : HelltechShotgun
{
	Tag "HellTech Shotgun w/ FrostShot (Tier 2 Upgrade)"
	
	Weapon.AmmoType1 "Shellz"
	Weapon.AmmoType2 "Shellz"
	Weapon.AmmoUse1 1
	Weapon.AmmoUse2 1
	
	Weapon.SisterWeapon "HelltechShotgun"
	+WEAPON.POWERED_UP
	
	States
	{
		Ready:
			KSGG A 1 A_WeaponReady
			Loop
		Deselect:
			KSGG AA 0 A_Lower
			KSGG A 1 A_Lower
			Loop
		Select:
			KSGG AA 0 A_Raise
			KSGG A 1 A_Raise
			Loop
		Fire:
			KSGG A 1 A_Playsound("Kunaishotgun_FIRE", CHAN_WEAPON)
			KSGG A 0 A_Jump(64, "CritFire")
			KSGG A 0 A_FireBullets (3, 3, 10, 6, "BulletPuff")			
			goto FireAnim
		AltFire:
			KSGG A 1 A_Playsound("FrostShot", CHAN_WEAPON)
			KSGG A 0 A_FireCustomMissile("FrostShotGrenade", frandom(-1.0, 1.0), true, 0, 0, 0, frandom(2.0, 3.0))
			goto FireAnim
		CritFire:
			KSGG A 0 A_PlaySound("GenericCrit", CHAN_AUTO)
			KSGG A 0 A_FireBullets (3, 3, 10, 10, "KunaisLifeStealingPuff")
			goto FireAnim
	}
}

ACTOR CryoBow : SH_Weapon
{
	Tag "Cryobow"
	Weapon.SlotNumber 5

	Weapon.AmmoType "RoketAmmo"
	Weapon.SelectionOrder 2
	Weapon.AmmoUse 1
	Weapon.AmmoGive 0 // Handled in ACS
		
	Inventory.Respawntics "4200"
	Inventory.RestrictedTo "Kunai"
	Inventory.PickupSound "weapon/bowget"
	Inventory.PickupMessage "You got the Cryobow"	
	
	Weapon.BobStyle "InverseSmooth"
	Weapon.BobSpeed 1.5
	Weapon.BobRangeX .5
	
	Weapon.SwayStyle "HorizontalOnly"
	Weapon.ViewSwaySpeed 1.0
	
	+WEAPON.NOAUTOAIM
	
	Obituary "%K was shattered by %o's Cryoshot"
	States
	{
	Spawn:
		WBOW A -1
		Stop
	Deselect:
		BOWG A 0 A_Jumpifinventory("Tier5upgradetoken",1,"GoldDeselect")
		BOWG AA 0 Bright A_Lower
		BOWG A 1 Bright A_Lower
		Loop
	Select:
		BOWG A 0 A_Jumpifinventory("Tier5upgradetoken",1,"Goldselect")
		BOWG AA 0 Bright A_Raise
		BOWG A 1 Bright A_Raise
		Loop
	Ready:
		BOWG A 0 A_Jumpifinventory("Tier5upgradetoken",1,"GoldReady")
		BOWG AAABBBCCCDDDBBB 1 Bright A_WeaponReady
		Loop
	GoldDeselect:
		GOWG AA 0 Bright A_Lower
		GOWG A 1 Bright A_Lower
		Loop
	GoldSelect:
		GOWG A 0 A_giveinventory("Tier5upgradetoken", 1)
		GOWG AA 0 Bright A_Raise
		GOWG A 1 Bright A_Raise
		Loop
	GoldReady:
		GOWG AAABBBCCCDDDBBB 1 Bright A_WeaponReady
		Loop
	Altfire:
		BOWG A 0 A_Jumpifinventory("Roketammo",5,1)
		Goto Ready
		BOWG A 0 A_Jumpifinventory("Tier5upgradetoken",1, "GOLDALTFIRE")
		BOWG A 0 A_JumpifInventory("GosimersAmmoSphere",1,"InfammoBluecharge")
		BOWG A 0 Bright
		BOWG A 0 Bright A_PlaySound("Weapon/Cryobow/Charge",chan_6)
		BOWG A 0 Bright
		BOWG A 0 Bright A_PlaySound("Weapon/Cryobow/Charge",chan_6)
		BOWG AAABBBCCCDDDBBB 2
		BOWF J 6 Bright
		BOWF K 5 Bright
	Althold:
		BOWG A 0 A_Jumpifinventory("Roketammo",5,1)
		Goto Ready
		BOWG A 0 A_Jumpifinventory("Tier5upgradetoken",1, "GoldAlthold")
		BOWF L 2 Bright
		BOWF M 2 Bright
		BOWF N 2 Bright
		BOWF O 2 Bright A_PlaySound("Weapon/Cryobow/Charged",chan_6)
		BOWF L 0 Bright A_refire
	BlueChargedFire:
		BOWF K 1 Bright A_takeinventory("Roketammo",5)
		BOWG A 0 Bright A_PlaySound("weapons/cryobowshot",chan_6)
		BOWG A 0 Bright A_PlaySound("weapons/cryobowfire", CHAN_WEAPON)
		BOWF A 0 Bright A_FireCustomMissile("SlowCryoShot",0,1)
		TNT1 A 0 Bright A_FireCustomMissile("SlowCryoShot",0,1)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotGold1",0,1,0,8,0)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotGold2",0,1,0,8,0)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotGold3",0,1,0,8,0)
		BOWF CD 2 Bright
		BOWF E 8
		BOWF E 2 A_PlaySound("weapons/cryobowreload",chan_6)
		BOWF E 2 Offset(0,31)
		BOWF F 2 Offset(0,32)
		BOWF F 2 Offset(0,30)
		BOWF G 2 Offset(0,31)
		BOWF HI 1 Offset(0,32)
		BOWG CDB 3 Bright Offset(0,32)
		Goto Ready
	InfammoBluecharge:
		BOWG A 0 Bright
		BOWG A 0 Bright A_PlaySound("Weapon/Cryobow/Charge",chan_6)
		BOWG AAABBBCCCDDDBBB 2
		BOWF J 6 Bright
		BOWF K 5 Bright
	INFAlthold:
		BOWG A 0 A_Jumpifinventory("Roketammo",5,1)
		Goto Ready
		BOWG A 0 A_Jumpifinventory("Tier5upgradetoken",1, "GoldAlthold")
		BOWF L 2 Bright
		BOWF M 2 Bright
		BOWF N 2 Bright
		BOWF O 2 Bright A_PlaySound("Weapon/Cryobow/Charged",chan_6)
		BOWF L 0 Bright A_refire
	INFBlueChargedFire:
		BOWG A 0 Bright A_PlaySound("weapons/cryobowshot",chan_6)
		BOWG A 0 Bright A_PlaySound("weapons/cryobowfire", CHAN_WEAPON)
		BOWF A 0 Bright A_FireCustomMissile("SlowCryoShot",0,1)
		TNT1 A 0 Bright A_FireCustomMissile("SlowCryoShot",0,1)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotGold1",0,1,0,8,0)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotGold2",0,1,0,8,0)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotGold3",0,1,0,8,0)
		BOWF CD 2 Bright
		BOWF E 8
		BOWF E 2 A_PlaySound("weapons/cryobowreload",chan_6)
		BOWF E 2 Offset(0,31)
		BOWF F 2 Offset(0,32)
		BOWF F 2 Offset(0,30)
		BOWF G 2 Offset(0,31)
		BOWF HI 1 Offset(0,32)
		BOWG CDB 3 Bright Offset(0,32)
		Goto Ready
	Fire:
		BOWG A 0 A_Jumpifinventory("Tier5upgradetoken",1, "GOLDFIRE")
		BOWG A 0 Bright A_GunFlash
		BOWG A 0 Bright A_PlaySound("weapons/cryobowshot",chan_6)
		BOWG A 0 Bright A_PlaySound("weapons/cryobowfire", CHAN_WEAPON)
		BOWF A 2 Bright A_FireCustomMissile("CryoShot",0,1)
		BOWF BCD 2 Bright
		BOWF E 8
		BOWF E 2 A_PlaySound("weapons/cryobowreload",chan_6)
		BOWF E 2 Offset(0,31)
		BOWF F 2 Offset(0,32)
		BOWF F 2 Offset(0,30)
		BOWF G 2 Offset(0,31)
		BOWF HI 1 Offset(0,32)
		BOWG CDB 3 Bright Offset(0,32)
		BOWG A 0 A_ReFire
		Goto Ready
	GoldFire:
		NULL A 0 A_Jump(75,"GoldFire2")
		GOWG A 0 Bright A_GunFlash
		GOWG A 0 Bright A_PlaySound("weapons/cryobowshot",chan_6)
		GOWG A 0 Bright A_PlaySound("weapons/cryobowfire", CHAN_WEAPON)
		GOWF A 2 Bright A_FireCustomMissile("GoldCryoShot",0,1)
		GOWF BCD 2 Bright
		GOWF E 8
		GOWF E 2 A_PlaySound("weapons/cryobowreload")
		GOWF E 2 Offset(0,31)
		GOWF F 2 Offset(0,32)
		GOWF F 2 Offset(0,30)
		GOWF G 2 Offset(0,31)
		GOWF HI 1 Offset(0,32)
		GOWG CDB 3 Bright Offset(0,32)
		GOWG A 0 A_ReFire
		Goto Ready
	GoldFire2:
		GOWG A 0 Bright A_GunFlash
		GOWG A 0 A_Giveinventory("Roketammo",1)
		GOWG A 0 Bright A_PlaySound("weapons/cryobowshot")
		GOWG A 0 Bright A_PlaySound("weapons/cryobowfire", CHAN_WEAPON)
		GOWF A 2 Bright A_FireCustomMissile("GoldCryoShot",0,1)
		GOWF BCD 2 Bright
		GOWF E 8
		GOWF E 2 A_PlaySound("weapons/cryobowreload")
		GOWF E 2 Offset(0,31)
		GOWF F 2 Offset(0,32)
		GOWF F 2 Offset(0,30)
		GOWF G 2 Offset(0,31)
		GOWF HI 1 Offset(0,32)
		GOWG CDB 3 Bright Offset(0,32)
		GOWG A 0 A_ReFire
		Goto Ready
	GoldAltfire:
		GOWG A 0 A_Jumpifinventory("Roketammo",5,1)
		Goto Ready
		GOWG A 0 A_JumpifInventory("GosimersAmmoSphere",1,"InfammoBluecharge")
		GOWG A 0 Bright
		GOWG A 0 Bright A_PlaySound("Weapon/Cryobow/Charge",chan_6)
		GOWG A 0 Bright
		GOWG A 0 Bright A_PlaySound("Weapon/Cryobow/Charge",chan_6)
		GOWG AAABBBCCCDDDBBB 2
		GOWF J 6 Bright
		GOWF K 5 Bright
	GOLDAlthold:
		GOWG A 0 A_Jumpifinventory("Roketammo",5,1)
		Goto Ready
		GOWF L 2 Bright
		GOWF M 2 Bright
		GOWF N 2 Bright
		GOWF O 2 Bright A_PlaySound("Weapon/Cryobow/Charged",chan_6)
		GOWF L 0 Bright A_refire
	GoldChargedFire:
		BOWG A 0 A_Jumpifinventory("Roketammo",5,1)
		Goto Ready
		GOWF A 1 Bright A_takeinventory("Roketammo",5,1)
		BOWG A 0 Bright A_PlaySound("weapons/cryobowshot",chan_6)
		BOWG A 0 Bright A_PlaySound("weapons/cryobowfire", CHAN_WEAPON)
		GOWF A 0 Bright A_FireCustomMissile("SlowGoldCryoShot",0,1)
		TNT1 A 0 Bright A_FireCustomMissile("SlowGoldCryoShot",0,1)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotBlue1",0,1,0,8,0)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotBlue2",0,1,0,8,0)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotBlue3",0,1,0,8,0)
		GOWF BCD 2 Bright
		GOWF E 8
		GOWF E 2 A_PlaySound("weapons/cryobowreload",chan_6)
		GOWF E 2 Offset(0,31)
		GOWF F 2 Offset(0,32)
		GOWF F 2 Offset(0,30)
		GOWF G 2 Offset(0,31)
		GOWF HI 1 Offset(0,32)
		GOWG CDB 3 Bright Offset(0,32)
		Goto Ready
	InfammoChargegold:
		GOWG A 0 Bright
		GOWG A 0 Bright A_PlaySound("weapon/Cryobow/Charge",chan_6)
		GOWG A 7 Bright
		GOWC A 7 Bright
		GOWC B 6 Bright
		GOWC C 5 Bright
	INFGoldAlthold:
		GOWF L 2 Bright
		GOWF M 2 Bright
		GOWF N 2 Bright
		GOWF O 2 Bright A_PlaySound("Weapon/Cryobow/Charged",chan_6)
		GOWF L 0 Bright A_refire
	INFGoldChargedFire:
		BOWG A 0 Bright A_PlaySound("weapons/cryobowshot",chan_6)
		BOWG A 0 Bright A_PlaySound("weapons/cryobowfire", CHAN_WEAPON)
		GOWF A 0 Bright A_FireCustomMissile("SlowGoldCryoShot",0,1)
		TNT1 A 0 Bright A_FireCustomMissile("SlowGoldCryoShot",0,1)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotBlue1",0,1,0,8,0)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotBlue2",0,1,0,8,0)
		TNT1 A 0 A_FireCustomMissile("ChargeCryoShotBlue3",0,1,0,8,0)
		GOWF BCD 2 Bright
		GOWF E 8
		GOWF E 2 A_PlaySound("weapons/cryobowreload",chan_6)
		GOWF E 2 Offset(0,31)
		GOWF F 2 Offset(0,32)
		GOWF F 2 Offset(0,30)
		GOWF G 2 Offset(0,31)
		GOWF HI 1 Offset(0,32)
		GOWG CDB 3 Bright Offset(0,32)
		Goto Ready
	Flash:
		TNT1 A 2 Bright A_Light1
		TNT1 A 2 Bright A_Light2
		TNT1 A 1 Bright A_Light1
		TNT1 A 0 A_Light0
		Goto LightDone
	}
}


ACTOR Streetsweeper : SH_Weapon
{
	Tag "Street Sweeper"

	Weapon.SlotNumber 3
	Weapon.SlotPriority 2
	Weapon.SelectionOrder 1
	
	Weapon.AmmoUse 1
	Weapon.AmmoGive 0 // Handled in ACS
	Weapon.AmmoType "SuperShellz"
	
	Weapon.BobSpeed 1.5
	Weapon.BobRangeX .5
	Weapon.BobStyle "InverseSmooth"
	
	Weapon.SwayStyle "HorizontalOnly"
	Weapon.ViewSwaySpeed 1.0
	
	Weapon.SisterWeapon "FrostStreetsweeper"
	Weapon.PowerupItem "Tier3upgradetoken"
	
	+WEAPON.NOAUTOAIM
	
	Inventory.RestrictedTo "Kunai"
	Inventory.Respawntics"4200"
	Inventory.PickupSound "weapon/streetsweeperget"
	Inventory.PickupMessage "You got the street sweaper! time to rock"
	
	Obituary "%o was decimated by %k's Street sweeper"
	States
	{
		Ready:
			STSW A 1 A_WeaponReady
			Loop
		
		Deselect:
			STSW AA 0 A_Lower
			STSW A 1 A_Lower
			Loop
		
		Select:
			STSW AA 0 A_Raise
			STSW A 1 A_Raise
			Loop
		
		Fire:
			STSW A 0 A_PlaySound("SSWFire", CHAN_WEAPON)
			STSW B 0 A_Recoil(1)
			STSW B 0 BRIGHT A_FireBullets(5, 5, 10, 4, "BulletPuff")
			goto FireAnim
		FireAnim:
			"####" B 0 BRIGHT A_GunFlash
			"####" B 0 BRIGHT A_ClientsideACSExecute("SET_RECOIL_VALUE", random(-4, 4), 0)
			"####" B 2 BRIGHT A_WeaponOffset(CallACS("GET_RECOIL_X", 0)/FIXED, 32, 0)
			"####" C 2 BRIGHT A_WeaponOffset(CallACS("GET_RECOIL_X", 1)/FIXED, 32, 0)
			"####" D 0 A_FireCustomMissile("SingleShotgunCasingSpawner", 0, 0, 0, 1)
			"####" D 2 A_WeaponOffset(CallACS("GET_RECOIL_X", 2)/FIXED, 32, 0)
			"####" E 2 A_WeaponOffset(CallACS("GET_RECOIL_X", 3)/FIXED, 32, 0)
			"####" F 2 A_WeaponOffset(CallACS("GET_RECOIL_X", 4)/FIXED, 32, 0)
			"####" A 3 A_WeaponOffset(0, 32, 0)
			"####" A 0 A_ReFire
			"####" A 0 A_JumpTo("Ready")
			Goto Ready
			
		Flash:
			TNT1 A 0 A_Light2
			TNT1 A 1 A_SetPitch(pitch-1.0)
			TNT1 A 0 A_Light1
			TNT1 AAAA 1 A_SetPitch(pitch+0.25)
			goto LightDone
		
		Spawn:
			STSP A -1
			Stop
	}
}

actor FrostStreetsweeper : StreetSweeper
{
	Tag "Streetsweeper w/ Frostshot (Tier 3 Upgrade)"
	
	Weapon.AmmoUse1 1
	Weapon.AmmoGive1 0 // Handled in ACS
	Weapon.AmmoType1 "SuperShellz"
	
	Weapon.AmmoUse2 1
	Weapon.AmmoGive2 0 // Handled in ACS
	Weapon.AmmoType2 "SuperShellz"
	
	Weapon.SisterWeapon "Streetsweeper"
	+WEAPON.POWERED_UP
	States
	{
		Ready:
			STSG A 1 A_WeaponReady
			Loop
		Deselect:
			STSG A 0 A_StopSound(CHAN_7)
			STSG AA 0 A_Lower
			STSG A 1 A_Lower
			Loop
		Select:
			STSG A 0 A_StopSound(CHAN_7)
			STSG AA 0 A_Raise
			STSG A 1 A_Raise
			Loop	
		
		Fire:
			STSG A 0 A_Jump(40, "Fire_Crit")
			STSG A 0 A_PlaySound("SSWFire", CHAN_WEAPON)
			STSG B 0 A_Recoil(2)
			STSG B 0 A_FireBullets(4, 4, 10, 5, "BulletPuff")
			goto FireAnim
		Fire_Crit:
			STSG A 0 A_PlaySound("SSWFire", CHAN_WEAPON)
			STSG A 0 A_PlaySound("GenericCrit", CHAN_AUTO)
			STSG B 0 A_Recoil(5)
			STSG B 0 A_FireBullets(4, 4, 10, 10, "KunaisLifeStealingPuff")
			goto FireAnim
		
		AltFire:
			STSG A 0 A_JumpIfNoAmmo("Ready")
			STSG A 0 A_PlaySound("SSWWindUp", CHAN_AUTO)
			STSG AG 3
			STSG HI 2
			STSG AGHI 1
			STSG AHI 1
			goto AltFireShoot
		AltFireShoot:
			STSG A 0 A_JumpIfNoAmmo("Ready")
			STSG A 0 A_PlaySound("SSWFire", CHAN_WEAPON)
			STSG A 0 A_FireCustomMissile ("FrostShotBallBig", frandom(-4.0, 4.0), true, 0, 0, 0, frandom(-2.0, 6.0))
			STSG AA 0 A_FireCustomMissile ("FrostShotBallBig", frandom(-4.0, 4.0), false, 0, 0, 0, frandom(-2.0, 6.0))
			goto AltFireAnim		
		AltFireAnim:
			"####" B 0 A_PlaySound("SSWSpin", CHAN_7, 1.0, true)
			"####" B 0 BRIGHT A_Recoil(0.5)
			"####" B 0 BRIGHT A_GunFlash
			"####" B 0 BRIGHT A_ClientsideACSExecute("SET_RECOIL_VALUE", random(-4, 4), 0)
			"####" B 1 BRIGHT A_WeaponOffset(CallACS("GET_RECOIL_X", 0)/FIXED, 32, 0)
			"####" C 1 BRIGHT A_WeaponOffset(CallACS("GET_RECOIL_X", 2)/FIXED, 32, 0)
			"####" F 0 A_FireCustomMissile("SingleShotgunCasingSpawner", 0, 0, 0, 1)
			"####" F 1 A_WeaponOffset(CallACS("GET_RECOIL_X", 4)/FIXED, 32, 0)
			"####" A 0 A_WeaponOffset(0, 32, 0)
			"####" A 0 A_Refire("AltFireShoot")
			"####" A 0 A_PlaySound("SSWWindDown", CHAN_7, 1.0, false)
			"####" AHI 1 A_Refire("AltFireShoot")
			"####" AGHI 1 A_Refire("AltFireShoot")
			"####" AG 2
			"####" HI 3
			"####" AGHI 4
			"####" A 0 A_Refire
			Goto Ready
	}
}

Actor PDW : SH_Weapon
{
	Tag "PDW"
	
	Weapon.SelectionOrder 3
	Weapon.SlotNumber 4
	
	Weapon.AmmoUse 1
	Weapon.AmmoGive 0 // Handled in ACS
	Weapon.AmmoType "MGRounds"
	
	Inventory.PickupSound"LMGGET"
	Inventory.PickupMessage "You got the PDW!"
	Inventory.RestrictedTo "Kunai"
	Inventory.Respawntics"4200"
	
	Weapon.BobSpeed 1.5
	Weapon.BobRangeX .5
	Weapon.BobStyle "InverseSmooth"
	
	Weapon.SwayStyle "HorizontalOnly"
	Weapon.ViewSwaySpeed 1.0
	
	Weapon.PowerupItem "Tier4upgradetoken"
	Weapon.SisterWeapon "DualPDWs"
	
	+WEAPON.NOAUTOAIM
	
	Obituary "%o Had a bad time by %k's PDW"
	
	States
	{
		Ready:
			KPDW A 1 A_WeaponReady
			Loop
		Deselect:
			KPDW AA 0 A_Lower
			KPDW A 1 A_Lower
			loop
		Select:
			KPDW AA 0 A_Raise
			KPDW A 1 A_Raise
			Loop
		Fire:
			KPDW A 0 A_FireCustomMissile("ChaingunCasingSpawner", 0, 0, 0, 1)
			KPDW A 0 A_PlaySound("PDWFire", CHAN_WEAPON)
			KPDW B 1 Bright A_GunFlash("Shoot")
			KPDW C 1 Bright
			KPDW A 2
			KPDW A 0 A_Refire
			goto Ready
		Shoot:
			TNT1 A 0 A_FireBullets(4, 1, 1, random(6,7), "Bulletpuff")
			goto Flash
		Hold:
			KPDW A 0 A_WeaponOffset(random(-3, 3), random(32, 35), 0)
			goto Fire
			
		Flash:
			TNT1 A 0 A_Light2
			TNT1 A 1 A_SetPitch(pitch-0.5)
			TNT1 A 0 A_Light1
			TNT1 AA 1 A_SetPitch(pitch+0.25)
			Goto Lightdone
		Spawn:
			AK4I A -1
			Stop
	}
}

actor DualPDWs : PDW
{
	Tag "Dual PDWs (Tier 4 Upgrade)"
	Weapon.SisterWeapon "PDW"
	
	+WEAPON.POWERED_UP
	
	States
	{
		Ready:
			KPL1 A 0 A_GunFlash("ReadyRight", GFF_NOEXTCHANGE)
			goto ReadyLeft
		ReadyLeft:
			KPL1 A 1 A_WeaponReady
			loop
		ReadyRight:
			KPR1 A 1 A_JumpIfInventory("DualFireHax", 1, "FireRight")
			loop
		
		Deselect:
			KPL1 A 0 A_GunFlash("SelectRight", GFF_NOEXTCHANGE)
			KPL1 AA 0 A_Lower
			KPL1 A 1 A_Lower
			loop
		Select:
			KPL1 A 0 A_GunFlash("SelectRight", GFF_NOEXTCHANGE)
			KPL1 AA 0 A_Raise
			KPL1 A 1 A_Raise
			Loop
		SelectRight: // Used by both select and deselect.
			KPR1 A 1
			stop
			
		Fire:
			"####" B 0 BRIGHT A_PlaySound("PDWFire", CHAN_WEAPON)
			"####" B 0 A_Jump(32, "Crit")
			goto Fire2
		Fire2:
			"####" B 0 A_FireBullets(5, 5, -1, random(6,7), "Bulletpuff")
			goto FireDone
		Crit:
			"####" B 0 A_PlaySound("GenericCrit", CHAN_AUTO)
			"####" B 0 A_FireBullets(5, 5, -1, 10, "KunaisLifeStealingPuff")
			goto FireDone
		FireDone:
			"####" B 1 Bright A_SetPitch(pitch-0.5)
			"####" C 1 A_SetPitch(pitch+0.25)
			"####" A 2 A_SetPitch(pitch+0.25)
			"####" A 0 A_ReFire("Hold")
			Goto ReadyLeft
		Hold:
			"####" A 0 A_Jump(256, "RattleLeft1", "RattleLeft2", "RattleLeft3", "RattleLeft4", "RattleLeft5")
			goto Fire
		RattleLeft1:
			KPL1 A 0
			goto Fire
		RattleLeft2:
			KPL2 A 0
			goto Fire
		RattleLeft3:
			KPL3 A 0
			goto Fire	
		RattleLeft4:
			KPL4 A 0
			goto Fire
		RattleLeft5:
			KPL4 A 0
			goto Fire
			
		FireRight:
			"####" B 0 A_JumpIfNoAmmo("DryFireRight")
			"####" B 0 BRIGHT A_PlaySound("PDWFire", CHAN_WEAPON)
			"####" B 0 BRIGHT A_AlertMonsters
			"####" B 0 A_Jump(32, "CritRight")
			goto FireRight2
		FireRight2:
			"####" B 0 A_FireBullets(5, 5, -1, random(6,7), "Bulletpuff")
			goto FireDoneRight
		CritRight:
			"####" B 0 A_PlaySound("GenericCrit", CHAN_AUTO)
			"####" B 0 A_FireBullets(5, 5, -1, 10, "KunaisLifeStealingPuff")
			goto FireDoneRight
		FireDoneRight:
			"####" B 1 Bright A_SetPitch(pitch-0.5)
			"####" C 1 A_SetPitch(pitch+0.25)
			"####" A 2 A_SetPitch(pitch+0.25)
			"####" A 0 A_JumpIfInventory("DualFireHax", 1, "HoldRight")
			Goto ReadyRight
			
		HoldRight:
			"####" A 0 A_Jump(256, "RattleRight1", "RattleRight2", "RattleRight3", "RattleRight4", "RattleRight5")
			goto FireRight
		RattleRight1:
			KPR1 A 0
			goto FireRight
		RattleRight2:
			KPR2 A 0
			goto FireRight
		RattleRight3:
			KPR3 A 0
			goto FireRight
		RattleRight4:
			KPR4 A 0
			goto FireRight
		RattleRight5:
			KPR5 A 0
			goto FireRight
			
		DryFireRight:
			KPR1 A 0 A_PlaySoundEx("weapons/pistol/dry","Weapon")
			KPR1 A 8 
			goto ReadyRight
	}
}

Actor KunaisKar98 : SH_Weapon
{
	Tag "Kar-98"
	
	Weapon.SlotNumber 7
	Weapon.SlotPriority 1
	Weapon.SelectionOrder 3
	
	Weapon.AmmoUse1 1
	Weapon.AmmoGive1 0 // Handled in ACS
	Weapon.AmmoType1 "Railslugs"
	
	
	Weapon.BobSpeed 1.5
	Weapon.BobRangeX .5
	Weapon.BobStyle "InverseSmooth"
	
	Weapon.SwayStyle "HorizontalOnly"
	Weapon.ViewSwaySpeed 1.0
	
	+WEAPON.NOAUTOAIM

	Inventory.RestrictedTo "Kunai"
	Inventory.Respawntics"4200"
	Inventory.PickupSound"weapon/RAILGET"
	Inventory.PickupMessage "You got the kar98!"
	
	Obituary "%o Got picked off by %k's Kar98"

	States
	{
		Select:
			KARG AA 0 A_Raise
			KARG A 1 A_Raise
			Loop
		Deselect:
			KARG AA 0 A_Lower
			KARG A 1 A_Lower
			Loop
		Ready:
			KARG A 1 A_WeaponReady
			loop
		Fire:
			KARG A 2 A_GunFlash
			KARG A 0 A_PlaySoundEx("weapon/K98FIRE","Weapon")
			KARF A 1 Bright A_FireBullets(0.5, 0.5, 1, 100)
			KARF B 1 Bright
			KARG A 1
			KARG B 2
			KARG C 3 A_PlaySoundEx("weapon/K98Boltback","SoundSlot5")
			KARG D 4
			KARG E 3
			KARG F 3
			KARG G 2 A_FireCustomMissile("ChaingunCasingSpawner", 0, 0, 0, 1)
			KARG H 5
			KARG I 2 A_PlaySoundEx("weapon/K98Boltforward","SoundSlot6")
			KARG J 3
			KARG K 4
			KARG L 3
			KARG A 2
			KARG A 1 A_Refire
			Goto Ready
		Flash:
			TNT1 A 1 A_LIGHT1
			TNT1 A 1 A_LIGHT2
			TNT1 A 0 A_Light0
			goto LightDone
		Spawn:
			 K98G A -1
			 Stop
	}
}

Actor Vortexgun : SH_Weapon
{
	Tag "Black Hole Generator"
	
	Weapon.SlotNumber 8
	Weapon.SelectionOrder 2900
	
	Weapon.AmmoUse 2
	Weapon.AmmoGive 0 // Handled in ACS
	Weapon.AmmoType "bfgcharge"	
	
	Weapon.BobSpeed 1.5
	Weapon.BobRangeX .5
	Weapon.BobStyle "InverseSmooth"
	
	Weapon.SwayStyle "HorizontalOnly"
	Weapon.ViewSwaySpeed 1.0
	
	+WEAPON.NOAUTOAIM
	
	Inventory.Restrictedto "Kunai"
	Inventory.PickupSound "weapon/vortexget"
	Inventory.PickupMessage "You got the Black Hole Generator!"
	
	Obituary "%o got disintegrated by %k's Black Hole Generator."
	
	States
	{
		Spawn:
			DCAN A -1
			Stop
		Select:
			DMAT A 0 A_JumpIfInventory("tier7upgradetoken", 1, "Goldselect")
			DMAT A 1 A_Raise
			Loop
		Deselect:
			DMAT A 0 A_JumpIfInventory("tier7upgradetoken", 1, "Golddeselect")
			DMAT A 1 A_Lower
			Loop
		Ready:
			DMAT A 0 A_JumpIfInventory("tier7upgradetoken", 1, "Goldready")
			DMAT A 1 A_WeaponReady
			Loop
		Fire:
			DMAT A 0 A_JumpIfInventory("Tier7upgradetoken",1,"Goldfire")
			DMAT A 30 A_PlayWeaponSound("DMC/Charge")
			DMAT A 10 Bright
			TNT1 A 0 A_PlayWeaponSound("DMC/Fire")
			TNT1 A 0 A_GunFlash
			DMAT B 4 Bright A_FireCustomMissile("DMBall", 0, true, 0, 0)
			DMAT CD 4 Bright
			DMAT A 10
			Goto Ready
		
		// GOLD VERSION
		GoldSelect:
			TNT1 A 0 A_giveinventory("Tier7upgradetoken", 1)
			DMAG A 1 A_Raise
			Loop
		GoldDeselect:
			DMAG A 1 A_Lower
			Loop
		GoldReady:
			DMAG A 1 A_WeaponReady
			Loop
		GoldFire:
			DMAG A 30 A_PlayWeaponSound("DMC/Charge")
			DMAG A 10 Bright
			TNT1 A 0 A_PlayWeaponSound("DMC/Fire")
			TNT1 A 0 A_GunFlash
			DMAG A 0 A_takeinventory("bfgcharge",1)
			DMAG B 4 Bright A_FireCustomMissile("DMBall", 0, true, 0, 0)
			DMAG CD 4 Bright
			DMAG A 10
			Goto Ready
		Flash:
			TNT1 A 4 A_Light2
			TNT1 A 3 A_Light1
			TNT1 A 0 A_Light0
			goto LightDone
	}
}

actor Channeler : SH_Weapon
{
	Tag "Channeler"
	
	Weapon.SlotNumber 7
	Weapon.SlotPriority 2
	Weapon.SelectionOrder 5
	
	Weapon.AmmoUse1 1
	Weapon.AmmoUse2 1
	Weapon.AmmoType1 "Battery"
	Weapon.AmmoType2 "Battery"
	Weapon.AmmoGive 0 // Handled in ACS
	Weapon.UpSound "Channeler/Up"
	
	Weapon.BobSpeed 1.5
	Weapon.BobRangeX .5
	Weapon.BobStyle "InverseSmooth"
	
	Weapon.SwayStyle "HorizontalOnly"
	Weapon.ViewSwaySpeed 1.0
	
	+WEAPON.NOAUTOAIM
	
	Inventory.RestrictedTo "Kunai"
	inventory.pickupsound "weapon/channlerget"
	inventory.pickupmessage "You got the Channeler!"
	
	Obituary "%o was burned by %k's volatile plasma."
	radius 20
	height 16
	states
	{
		Ready:
			AMCC A 0 A_Jumpifinventory("Tier6upgradetoken",1, "Goldready")
			AMCC BCDEFG 2 BRIGHT A_WeaponReady(WRF_NOSECONDARY)
			AMCC A 0 A_StopSound(CHAN_7)
			loop
		Deselect: 
			AMCC A 0 A_Jumpifinventory("Tier6upgradetoken",1, "Golddeselect")
			AMCC BB 0 BRIGHT A_Lower
			AMCC B 1 BRIGHT A_Lower
			AMCC B 0 A_StopSound(CHAN_7)
			loop
		Select:
			AMCC A 0 A_Jumpifinventory("Tier6upgradetoken",1, "Goldselect")
			AMCC BB 0 BRIGHT A_Raise
			AMCC B 1 BRIGHT A_Raise
			AMCC B 0 A_StopSound(CHAN_7)
			loop
		
		Fire:
			AMCC A 0 A_Jumpifinventory("Tier6upgradetoken",1, "GoldFire")
			AMCC A 0 A_GunFlash
			AMCC A 0 A_PlaySound("Channeler/AltFire", CHAN_7)
			AMCC G 1 BRIGHT
			AMCC H 1 BRIGHT A_FireCustomMissile("ChannelerSeducer", 0, 1, 0, 0)
			AMCC I 1 BRIGHT
			AMCC A 0 A_GunFlash
			AMCC A 0 A_PlaySound("Channeler/AltFire", CHAN_7)
			AMCC G 1 BRIGHT
			AMCC H 1 BRIGHT A_FireCustomMissile("ChannelerSeducer", 0, 1, 0, 0)
			AMCC I 1 BRIGHT
			AMCC A 0 A_GunFlash
			AMCC A 0 A_PlaySound("Channeler/AltFire", CHAN_7)
			AMCC G 1 BRIGHT
			AMCC H 1 BRIGHT A_FireCustomMissile("ChannelerSeducer", 0, 1, 0, 0)
			AMCC I 1 BRIGHT
			AMCC JKL 2 BRIGHT
			AMCC B 0 Bright A_ReFire
			goto Ready
		GOLDReady:
			AMGC BCDEFG 2 BRIGHT A_WeaponReady
			AMGC A 0 A_StopSound(CHAN_7)
			loop
		GOLDDeselect: 
			AMGC BB 0 BRIGHT A_Lower
			AMGC B 1 BRIGHT A_Lower
			AMGC B 0 A_StopSound(CHAN_7)
			loop
		GOLDSelect:
			TNT1 A 0 A_giveinventory("Tier6upgradetoken", 1)
			AMGC BB 0 BRIGHT A_Raise
			AMGC B 1 BRIGHT A_Raise
			AMGC B 0 A_StopSound(CHAN_7)
			loop
		GoldFire:
			AMGC H 0 A_PlaySound("Channeler/Fire", CHAN_7, 1.0, true)
			AMGC H 0 A_GunFlash
			AMGC H 1 BRIGHT A_FireCustomMissile("REDChannelerBeam", 0, true, 0, 0)
			AMGC I 1 BRIGHT
			AMGC J 1 BRIGHT A_FireCustomMissile("REDChannelerBeam", 0, 0, 0, 0)
			AMGC K 1 BRIGHT
			AMGC L 1 BRIGHT A_FireCustomMissile("REDChannelerBeam", 0, 0, 0, 0)
			AMGC G 0 A_Refire
			AMGC G 0 A_StopSound(CHAN_7)
			goto Ready
		AltFire: // Gold only
			AMGC A 0 A_GunFlash
			AMGC A 0 A_PlaySound("Channeler/AltFire", CHAN_7)
			AMGC G 1 BRIGHT
			AMGC H 1 BRIGHT A_FireCustomMissile("REDChannelerSeducer", 0, 1, 0, 0)
			AMGC I 1 BRIGHT
			AMGC A 0 A_GunFlash
			AMGC A 0 A_PlaySound("Channeler/AltFire", CHAN_7)
			AMGC G 1 BRIGHT
			AMGC H 1 BRIGHT A_FireCustomMissile("REDChannelerSeducer", 0, 1, 0, 0)
			AMGC I 1 BRIGHT
			AMGC A 0 A_GunFlash
			AMGC A 0 A_PlaySound("Channeler/AltFire", CHAN_7)
			AMGC G 1 BRIGHT
			AMGC H 1 BRIGHT A_FireCustomMissile("REDChannelerSeducer", 0, 1, 0, 0)
			AMGC I 1 BRIGHT
			AMGC JKL 2 BRIGHT
			AMGC B 0 Bright A_ReFire
			goto Ready
		Flash:
			TNT1 A 1 bright A_Light1
			TNT1 A 1 bright A_Light2
			TNT1 A 0 bright A_Light0
			goto LightDone
		Spawn:
			AMCC A -1
			Stop
	}
}